<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Words</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            overflow: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .floating-text {
            position: fixed;
            color: #fff;
            pointer-events: none;
            z-index: 100;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            white-space: nowrap;
            font-family: "Microsoft YaHei", sans-serif;
            transform-origin: center;
        }

        .floating-text::before {
            content: '‚ù§Ô∏è';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5em;
            opacity: 0.2;
            z-index: -1;
            animation: pulse 2s infinite;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) translateX(0) rotate(-5deg) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(80vh) translateX(-20px) rotate(-2deg) scale(0.8);
            }
            40% {
                transform: translateY(50vh) translateX(20px) rotate(2deg) scale(1.2);
            }
            60% {
                transform: translateY(30vh) translateX(-10px) rotate(-1deg) scale(1.4);
            }
            80% {
                transform: translateY(10vh) translateX(10px) rotate(1deg) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) translateX(0) rotate(0) scale(0.8);
                opacity: 0;
            }
        }

        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        #music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .music-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .music-icon.paused {
            animation-play-state: paused;
        }

        #music-control:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .big-heart {
            position: fixed;
            z-index: 50;
            width: 100px;
            height: 100px;
            color: #ff4d4d;
            font-size: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            filter: drop-shadow(0 0 10px rgba(255, 77, 77, 0.5));
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .big-heart:hover {
            transform: scale(1.1);
        }

        /* Ê∑ªÂä†ÁÉüËä±Á≤íÂ≠êÊ†∑Âºè */
        .firework-particle {
            position: fixed;
            pointer-events: none;
            border-radius: 50%;
            z-index: 49;
        }

        @keyframes explode {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        /* Ê∑ªÂä†ÈÅÆÁΩ©Â±ÇÊ†∑Âºè */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            z-index: 2000;
            transition: opacity 1s ease;
        }

        /* Êõ¥Êñ∞‰ø°Â∞ÅÊ†∑Âºè */
        .envelope {
            position: fixed;
            width: 300px;  /* Â¢ûÂä†ÂÆΩÂ∫¶ */
            height: 200px; /* Â¢ûÂä†È´òÂ∫¶ */
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
            transform-style: preserve-3d;
            transition: all 0.6s ease;
            z-index: 2001;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid rgba(255, 182, 193, 0.3);
            opacity: 0; /* ÂàùÂßãËÆæÁΩÆ‰∏∫‰∏çÂèØËßÅ */
        }

        .envelope:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .envelope-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fff6f6, #fff);
            border-radius: 10px;
            overflow: hidden;
        }

        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffefef, #ffe4e1);
            clip-path: polygon(0 0, 50% 50%, 100% 0);
            transform-origin: top;
            transition: transform 0.6s ease;
            border-top: 2px solid rgba(255, 182, 193, 0.5);
        }

        /* Ê∑ªÂä†‰ø°Â∞ÅË£ÖÈ•∞ */
        .envelope-decoration {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: 
                linear-gradient(45deg, transparent 48%, #ffb6c1 49%, #ffb6c1 51%, transparent 52%) 0 0/20px 20px,
                linear-gradient(-45deg, transparent 48%, #ffb6c1 49%, #ffb6c1 51%, transparent 52%) 0 0/20px 20px;
            opacity: 0.1;
        }

        /* Êõ¥Êñ∞‰ø°Â∞Å‰∏≠ÁöÑÁà±ÂøÉÊ†∑Âºè */
        .envelope-heart {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff4d4d;
            font-size: 60px; /* Â¢ûÂ§ßÁà±ÂøÉÂ§ßÂ∞è */
            opacity: 0;
            transition: all 0.3s ease;
            text-shadow: 0 0 10px rgba(255, 77, 77, 0.3);
        }

        .envelope.opening .envelope-heart {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.2);
        }

        /* Ê∑ªÂä†‰ø°Â∞ÅÂç∞Á´† */
        .envelope-seal {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #ff4d4d;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
            opacity: 0.9;
            box-shadow: 0 2px 10px rgba(255, 77, 77, 0.3);
            z-index: 1;
        }

        /* Êõ¥Êñ∞È£ûÂÖ•Âä®Áîª */
        @keyframes flyIn {
            0% {
                opacity: 0;
                transform: translate(calc(100vw - 150px), -100vh) rotate(45deg) scale(0.5);
                filter: blur(3px);
            }
            30% {
                opacity: 1;
            }
            60% {
                transform: translate(-50%, -50%) rotate(-10deg) scale(1.2);
                filter: blur(0);
            }
            75% {
                transform: translate(-50%, -50%) rotate(5deg) scale(1.1);
            }
            90% {
                transform: translate(-50%, -50%) rotate(-3deg) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) rotate(0) scale(1);
            }
        }

        /* Êõ¥Êñ∞ÊâìÂºÄÂä®Áîª */
        @keyframes open {
            0% {
                transform: translate(-50%, -50%) scale(1);
                filter: blur(0);
            }
            20% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            60% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(20);
                filter: blur(10px);
                opacity: 0;
            }
        }

        /* ÈöêËóè‰∏ªË¶ÅÂÜÖÂÆπÁõ¥Âà∞‰ø°Â∞ÅÊâìÂºÄ */
        .main-content {
            opacity: 0;
            transition: opacity 1s ease;
        }

        .main-content.visible {
            opacity: 1;
        }

        .envelope.flying {
            animation: flyIn 1.5s ease forwards;
        }

        .envelope.opening {
            animation: open 1.5s ease forwards;
        }

        .envelope.opening .envelope-flap {
            transform: rotateX(180deg);
        }

        .music-title {
            font-size: 12px;
            margin-top: 5px;
            color: white;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            white-space: nowrap;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .music-list {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: none;
            z-index: 1000;
        }

        .music-list.show {
            display: block;
        }

        .music-item {
            padding: 8px 15px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            border-radius: 5px;
            color: #666;
        }

        .music-item:hover {
            background: rgba(255, 155, 155, 0.2);
            color: #ff4d4d;
        }

        .music-item.active {
            background: rgba(255, 77, 77, 0.1);
            color: #ff4d4d;
        }

        /* Ê∑ªÂä†Áõ∏Ê°ÜÊ†∑Âºè */
        .photo-frame {
            position: fixed;
            width: 200px;
            height: 250px;
            background: white;
            border: 10px solid #f8f8f8;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            transform: rotate(0deg);
            opacity: 0;
            z-index: 48;
            padding: 10px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .photo-frame:hover {
            transform: scale(1.1) rotate(0deg) !important;
        }

        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-frame::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 20px;
            background: #ddd;
            clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%);
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="envelope">
        <div class="envelope-front">
            <div class="envelope-flap"></div>
            <div class="envelope-decoration"></div>
            <div class="envelope-seal">‚ù§Ô∏è</div>
            <div class="envelope-heart">‚ù§Ô∏è</div>
        </div>
    </div>
    
    <div class="main-content">
        <div id="music-control">
            <div class="music-icon">üéµ</div>
            <div class="music-title">ÁÇπÂáªÂàáÊç¢Èü≥‰πê</div>
            <div class="music-list">
              
                <div class="music-item active" data-src="/love-site/music/This Could Be You.mp3">This Could Be You</div>
      
            </div>
        </div>
        <audio id="bgMusic" loop>
            <source src="/love-site/music/This Could Be You.mp3" type="audio/mpeg">
        </audio>

        <script>
            const loveWords = [
                'ÈÇπÊòïÁë∂',
                'ÊàëÁà±‰Ω†',
                'ÂñúÊ¨¢‰Ω†',
                'ÂÆùË¥ù',
                '‰∫≤Áà±ÁöÑ',
                'ÊúÄÁà±‰Ω†',
                'Ê∞∏ËøúÁà±‰Ω†',
                '‰∏ÄÁîü‰∏Ä‰∏ñ'
            ];

            function getRandomColor() {
                const colors = [
                    '#ff6b6b',
                    '#ff8787',
                    '#ffa8a8',
                    '#ff4d4d',
                    '#ff3366',
                    '#ff99cc',
                    '#ff66b2',
                    '#ff0066'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            function createFloatingWord() {
                const word = document.createElement('div');
                word.className = 'floating-text';
                word.textContent = loveWords[Math.floor(Math.random() * loveWords.length)];
                
                // Â¢ûÂº∫ÈöèÊú∫ÊïàÊûú
                const startX = Math.random() * (window.innerWidth - 100);
                const fontSize = Math.random() * 30 + 15; // ‰øÆÊîπÂ≠ó‰ΩìÂ§ßÂ∞èËåÉÂõ¥‰∏∫15-45px
                
                word.style.left = startX + 'px';
                word.style.fontSize = fontSize + 'px';
                word.style.color = getRandomColor();
                
                // ÈöèÊú∫Âä®ÁîªÊó∂ÈïøÂíåÂª∂Ëøü
                const duration = Math.random() * 3 + 4; // 4-7Áßí
                const delay = Math.random() * 0.8; // 0-0.8ÁßíÂª∂Ëøü
                
                word.style.animation = `floatUp ${duration}s ease-in-out ${delay}s`;
                
                document.body.appendChild(word);
                
                word.addEventListener('animationend', () => {
                    word.remove();
                });
            }

            // ‰øÆÊîπÂàõÂª∫Â§ßÁà±ÂøÉÁöÑÂáΩÊï∞
            function createBigHeart() {
                const heart = document.createElement('div');
                heart.className = 'big-heart';
                heart.innerHTML = '‚ù§Ô∏è';
                
                // ËÆæÁΩÆÂàùÂßã‰ΩçÁΩÆÂú®Â±èÂπïÂ∫ïÈÉ®
                const x = Math.random() * (window.innerWidth - 200) + 100;
                heart.style.left = x + 'px';
                heart.style.top = window.innerHeight + 'px';
                
                // ÈöèÊú∫Â§ßÂ∞è
                const baseSize = Math.random() * 40 + 80;
                heart.style.fontSize = baseSize + 'px';
                
                // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                heart.addEventListener('click', function(e) {
                    createFirework(e.clientX, e.clientY, baseSize);
                    this.remove();
                });
                
                document.body.appendChild(heart);
                
                // Ê∑ªÂä†‰∏äÂçáÂä®Áîª
                const duration = Math.random() * 3 + 5; // 5-8ÁßíÁöÑÂä®ÁîªÊó∂Èïø
                const rotateAmount = Math.random() * 20 - 10; // -10Âà∞10Â∫¶ÁöÑÈöèÊú∫ÊóãËΩ¨
                
                heart.animate([
                    { 
                        transform: `translateY(0) rotate(0deg) scale(0.2)`,
                        opacity: 0
                    },
                    {
                        transform: `translateY(-${window.innerHeight * 0.2}px) rotate(${rotateAmount/2}deg) scale(1.2)`,
                        opacity: 1,
                        offset: 0.2
                    },
                    {
                        transform: `translateY(-${window.innerHeight + 100}px) rotate(${rotateAmount}deg) scale(1)`,
                        opacity: 1
                    }
                ], {
                    duration: duration * 1000,
                    easing: 'ease-out',
                    fill: 'forwards'
                });
                
                // Âä®ÁîªÁªìÊùüÂêéÁßªÈô§ÂÖÉÁ¥†
                setTimeout(() => {
                    heart.remove();
                }, duration * 1000);
            }

            // ‰øÆÊîπÂàõÂª∫ÁÉüËä±ÊïàÊûúÁöÑÂáΩÊï∞ÔºåÊ∑ªÂä†Áõ∏Ê°ÜÊòæÁ§∫
            function createFirework(x, y, size) {
                const colors = [
                    '#ff4d4d', '#ff6b6b', '#ff8787', 
                    '#ff9999', '#ffb3b3', '#ffcccc'
                ];
                const particles = 30;
                const duration = 1000;

                // ÂàõÂª∫ÁÉüËä±Á≤íÂ≠ê
                for (let i = 0; i < particles; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'firework-particle';
                    
                    // ÈöèÊú∫ËßíÂ∫¶ÂíåË∑ùÁ¶ª
                    const angle = (i / particles) * 360 + Math.random() * 30;
                    const velocity = 3 + Math.random() * 3;
                    const distance = size * (0.5 + Math.random() * 0.5);
                    
                    const tx = Math.cos(angle * Math.PI / 180) * distance * velocity;
                    const ty = Math.sin(angle * Math.PI / 180) * distance * velocity;
                    
                    particle.style.cssText = `
                        left: ${x}px;
                        top: ${y}px;
                        width: ${size/10}px;
                        height: ${size/10}px;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        --tx: ${tx}px;
                        --ty: ${ty}px;
                    `;
                    
                    particle.animate([
                        { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                        { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                    ], {
                        duration: duration + Math.random() * 300,
                        easing: 'cubic-bezier(0,0,0.2,1)'
                    });
                    
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), duration + 300);
                }

                // ÁÉüËä±ÊïàÊûúÁªìÊùüÂêéÊòæÁ§∫Áõ∏Ê°Ü
                setTimeout(() => {
                    const frame = document.createElement('div');
                    frame.className = 'photo-frame';
                    
                    // ÂàõÂª∫ÂõæÁâáÂÖÉÁ¥†
                    const img = document.createElement('img');
                    img.src = photos[Math.floor(Math.random() * photos.length)];
                    frame.appendChild(img);
                    
                    // ‰ΩøÁî®ÁàÜÁÇ∏‰ΩçÁΩÆ‰Ωú‰∏∫Áõ∏Ê°Ü‰ΩçÁΩÆ
                    frame.style.left = (x - 100) + 'px'; // Â±Ö‰∏≠ÊòæÁ§∫
                    frame.style.top = (y - 125) + 'px';  // Â±Ö‰∏≠ÊòæÁ§∫
                    
                    // ÈöèÊú∫ÊóãËΩ¨ËßíÂ∫¶
                    const rotation = Math.random() * 20 - 10;
                    
                    // Ê∑ªÂä†Âá∫Áé∞Âä®Áîª
                    frame.animate([
                        { 
                            transform: `scale(0.2) rotate(${rotation}deg)`,
                            opacity: 0 
                        },
                        { 
                            transform: `scale(1) rotate(${rotation}deg)`,
                            opacity: 1 
                        }
                    ], {
                        duration: 500,
                        easing: 'ease-out',
                        fill: 'forwards'
                    });
                    
                    document.body.appendChild(frame);
                    
                    // 3ÁßíÂêéÊ∂àÂ§±
                    setTimeout(() => {
                        frame.animate([
                            { 
                                transform: `scale(1) rotate(${rotation}deg)`,
                                opacity: 1 
                            },
                            { 
                                transform: `scale(0.2) rotate(${rotation}deg)`,
                                opacity: 0 
                            }
                        ], {
                            duration: 500,
                            easing: 'ease-in',
                            fill: 'forwards'
                        }).onfinish = () => frame.remove();
                    }, 3000);
                }, duration);
            }

            // ‰øÆÊîπÂÆöÊó∂ÂàõÂª∫Â§ßÁà±ÂøÉÁöÑÈó¥Èöî
            function startBigHeartInterval() {
                // ÊØè5-8ÁßíÂàõÂª∫‰∏Ä‰∏™Â§ßÁà±ÂøÉ
                const minInterval = 5000;
                const maxInterval = 8000;

                function scheduleNextHeart() {
                    const nextInterval = Math.random() * (maxInterval - minInterval) + minInterval;
                    setTimeout(() => {
                        createBigHeart();
                        scheduleNextHeart();
                    }, nextInterval);
                }

                // Á´ãÂç≥ÂàõÂª∫Á¨¨‰∏Ä‰∏™Â§ßÁà±ÂøÉ
                setTimeout(createBigHeart, 1000);
                scheduleNextHeart();
            }

            // Èù¢Âä†ËΩΩÂêéÂºÄÂßãÂàõÂª∫ÊºÇÊµÆÊñáÂ≠ó
            window.addEventListener('load', function() {
                // Èôç‰ΩéÂàõÂª∫È¢ëÁéáÔºå‰ΩÜÂ¢ûÂä†ÊØèÊ¨°ÂàõÂª∫ÁöÑÊï∞Èáè
                setInterval(() => {
                    // ÊØèÊ¨°ÂàõÂª∫1-3‰∏™ÊñáÂ≠ó
                    const count = Math.floor(Math.random() * 2) + 1;
                    for(let i = 0; i < count; i++) {
                        setTimeout(createFloatingWord, i * 100);
                    }
                }, 1000);
                
                // ÂàùÂßãÂàõÂª∫Êõ¥Â§öÊñáÂ≠ó
                for(let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        createFloatingWord();
                    }, i * 150);
                }

                // Â∞ùËØïËá™Âä®Êí≠ÊîæÈü≥
                bgMusic.play().catch(function(error) {
                    console.log('ÈúÄË¶ÅÁî®Êà∑‰∫§‰∫íÊâçËÉΩÊí≠ÊîæÈü≥‰πê');
                });

                // Ê∑ªÂä†È°µÈù¢ÁÇπÂáªÊó∂Êí≠ÊîæÈü≥‰πêÁöÑÂäüËÉΩ
                document.addEventListener('click', function initAudio() {
                    if (!isPlaying) {
                        bgMusic.play().then(() => {
                            isPlaying = true;
                            document.querySelector('.music-icon').classList.remove('paused');
                        }).catch(error => {
                            console.log('Êí≠ÊîæÂ§±Ë¥•:', error);
                        });
                    }
                    // Âè™ÈúÄË¶ÅËß¶Âèë‰∏ÄÊ¨°
                    document.removeEventListener('click', initAudio);
                });

                // ÂºÄÂßãÂàõÂª∫Â§ßÁà±ÂøÉ
                startBigHeartInterval();
            });

            // Èü≥‰πêÊéßÂà∂Áõ∏ÂÖ≥ÂèòÈáè
            const musicControl = document.getElementById('music-control');
            const musicList = document.querySelector('.music-list');
            const musicTitle = document.querySelector('.music-title');
            const bgMusic = document.getElementById('bgMusic');
            const musicItems = document.querySelectorAll('.music-item');
            let isPlaying = false;

            // ÊòæÁ§∫/ÈöêËóèÈü≥‰πêÂàóË°®
            musicControl.addEventListener('click', function(e) {
                if (!e.target.classList.contains('music-item')) {
                    musicList.classList.toggle('show');
                }
            });

            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠Èü≥‰πêÂàóË°®
            document.addEventListener('click', function(e) {
                if (!musicControl.contains(e.target)) {
                    musicList.classList.remove('show');
                }
            });

            // È¢ÑÂä†ËΩΩÈü≥‰πêÊñá‰ª∂
            function preloadMusic(src) {
                return new Promise((resolve, reject) => {
                    const audio = new Audio();
                    audio.preload = 'auto'; // ËÆæÁΩÆÈ¢ÑÂä†ËΩΩ
                    audio.src = src;
                    audio.addEventListener('canplaythrough', () => resolve(audio));
                    audio.addEventListener('error', reject);
                    // ÂºÄÂßãÂä†ËΩΩ
                    audio.load();
                });
            }

            // ‰øÆÊîπÈü≥‰πêÂàáÊç¢ÂáΩÊï∞
            async function switchMusic(src, title) {
                try {
                    // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                    musicTitle.textContent = 'Âä†ËΩΩ‰∏≠...';
                    
                    // ÂÅúÊ≠¢ÂΩìÂâçÊí≠ÊîæÁöÑ‰πê
                    if (bgMusic.src) {
                        bgMusic.pause();
                    }

                    // È¢ÑÂä†ËΩΩÊñ∞Èü≥‰πê
                    await preloadMusic(src);
                    
                    // Êõ¥Êñ∞Èü≥‰πêÊ∫êÂíåÊ†áÈ¢ò
                    bgMusic.src = src;
                    musicTitle.textContent = title;
                    
                    // Â¶ÇÊûú‰πãÂâçÂú®Êí≠ÊîæÁä∂ÊÄÅÔºåÂàôËá™Âä®Êí≠ÊîæÊñ∞Èü≥‰πê
                    if (isPlaying) {
                        bgMusic.play().catch(error => {
                            console.log('Êí≠ÊîæÂ§±Ë¥•:', error);
                        });
                    }
                } catch (error) {
                    console.error('Èü≥‰πêÂä†ËΩΩÂ§±Ë¥•:', error);
                    musicTitle.textContent = 'Âä†ËΩΩÂ§±Ë¥•';
                }
            }

            // ‰øÆÊîπÈü≥‰πêÈ°πÁÇπÂáª‰∫ã‰ª∂
            function bindMusicItemEvents() {
                const musicItems = document.querySelectorAll('.music-item');
                musicItems.forEach(item => {
                    item.addEventListener('click', function() {
                        const src = this.dataset.src;
                        const title = this.textContent;
                        
                        // Êõ¥Êñ∞ÊøÄÊ¥ªÁä∂ÊÄÅ
                        musicItems.forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                        
                        // ÂàáÊç¢Èü≥‰πê
                        switchMusic(src, title);
                        
                        // ÂÖ≥Èó≠Èü≥‰πêÂàóË°®
                        musicList.classList.remove('show');
                    });
                });
            }

            // ‰ºòÂåñÈü≥È¢ëÂÖÉÁ¥†ËÆæÁΩÆ
            bgMusic.preload = 'auto';
            bgMusic.addEventListener('waiting', () => {
                musicTitle.textContent = 'ÁºìÂÜ≤‰∏≠...';
            });
            bgMusic.addEventListener('playing', () => {
                musicTitle.textContent = musicTitle.dataset.title || 'Ê≠£Âú®Êí≠Êîæ';
            });

            // Ê∑ªÂä†È°µÈù¢ÂèØËßÅÊÄßÊîπÂèòÊó∂ÁöÑÈü≥‰πêÊéßÂà∂
            document.addEventListener('visibilitychange', function() {
                const musicIcon = document.querySelector('.music-icon');
                if (document.hidden && isPlaying) {
                    bgMusic.pause();
                    musicIcon.classList.add('paused');
                } else if (!document.hidden && isPlaying) {
                    bgMusic.play().catch(function(error) {
                        console.log('Ëá™Âä®Êí≠ÊîæÂ§±Ë¥•');
                    });
                    musicIcon.classList.remove('paused');
                }
            });

            // ‰ø°Â∞ÅÊéßÂà∂
            const envelope = document.querySelector('.envelope');
            const overlay = document.querySelector('.overlay');
            const mainContent = document.querySelector('.main-content');
            let envelopeOpened = false;

            // È°µÈù¢Âä†ËΩΩÂêéÂºÄÂßã‰ø°Â∞ÅÈ£ûÂÖ•Âä®Áîª
            window.addEventListener('load', function() {
                // Áü≠ÊöÇÂª∂ËøüÂêéÂºÄÂßãÈ£ûÂÖ•Âä®Áîª
                setTimeout(() => {
                    envelope.classList.add('flying');
                }, 500);
            });

            // ‰ø°Â∞ÅÁÇπÂáª‰∫ã‰ª∂
            envelope.addEventListener('click', function() {
                if (!envelopeOpened) {
                    envelopeOpened = true;
                    this.classList.remove('flying');
                    this.classList.add('opening');
                    
                    // Êí≠ÊîæÈü≥‰πê
                    bgMusic.play().catch(function(error) {
                        console.log('ÈúÄË¶ÅÁî®Êà∑‰∫§‰∫íÊâçËÉΩÊí≠ÊîæÈü≥‰πê');
                    });
                    
                    // Á≠âÂæÖ‰ø°Â∞ÅÊâìÂºÄÂä®ÁîªÂÆåÊàêÂêéÊòæÁ§∫‰∏ªÂÜÖÂÆπ
                    setTimeout(() => {
                        overlay.style.opacity = '0';
                        mainContent.classList.add('visible');
                        
                        // ÁßªÈô§ÈÅÆÁΩ©Âíå‰ø°Â∞Å
                        setTimeout(() => {
                            envelope.remove();
                            overlay.remove();
                            
                            // Áõ¥Êé•ÂºÄÂßãÂàõÂª∫ÊºÇÊµÆÊñáÂ≠óÂíåÂ§ßÁà±ÂøÉÔºåÁßªÈô§ÂØπstartFloatingWordsÁöÑÂºïÁî®
                            setInterval(() => {
                                const count = Math.floor(Math.random() * 2) + 1;
                                for(let i = 0; i < count; i++) {
                                    setTimeout(createFloatingWord, i * 100);
                                }
                            }, 1000);
                            startBigHeartInterval();
                        }, 1000);
                    }, 800);
                }
            });

            // ‰øÆÊîπÂéüÊúâÁöÑ load ‰∫ã‰ª∂Â§ÑÁêÜ
            window.addEventListener('load', function() {
                // ÁßªÈô§Ëá™Âä®ÂºÄÁöÑ‰ª£Á†ÅÔºåÁ≠âÂæÖ‰ø°Â∞ÅÂºÄÂêéÂÜçÂºÄÂßã
                // ‰øùÁïôÈü≥‰πêÁõ∏ÂÖ≥ÁöÑ‰ª£Á†Å
                bgMusic.play().catch(function(error) {
                    console.log('ÈúÄË¶ÅÁî®Êà∑‰∫§‰∫íÊâçËÉΩÊí≠ÊîæÈü≥‰πê');
                });

                document.addEventListener('click', function initAudio() {
                    if (!isPlaying) {
                        bgMusic.play().then(() => {
                            isPlaying = true;
                            document.querySelector('.music-icon').classList.remove('paused');
                        }).catch(error => {
                            console.log('Êí≠ÊîæÂ§±Ë¥•:', error);
                        });
                    }
                    document.removeEventListener('click', initAudio);
                });
            });

            // ÈªòËÆ§Èü≥‰πêÂàóË°®
            const defaultMusic = [
                { src: '/love-site/music/bgm.mp3', name: 'This Could Be You' },
            ];

            // ‰øÆÊîπ scanMusicFolder ÂáΩÊï∞
            async function scanMusicFolder() {
                try {
                    const response = await fetch('/love-site/backend/music/');
                    if (!response.ok) {
                        throw new Error('Failed to load music directory');
                    }
                    
                    const text = await response.text();
                    let files;
                    try {
                        files = JSON.parse(text);
                    } catch (e) {
                        console.error('JSON parse error:', e, 'Response text:', text);
                        throw new Error('Invalid JSON response');
                    }
                    
                    if (Array.isArray(files)) {
                        updateMusicList(files.map(file => ({
                            src: `/love-site/backend/music/${encodeURIComponent(file)}`,
                            name: file.replace('.mp3', '')
                        })));
                    } else {
                        throw new Error('Invalid response format');
                    }
                } catch (error) {
                    console.error('Error loading music directory:', error);
                    // ‰ΩøÁî®ÈªòËÆ§Èü≥‰πêÂàóË°®
                    updateMusicList(defaultMusic);
                }
            }

            // Ê∑ªÂä†Êõ¥Êñ∞Èü≥‰πêÂàóË°®ÁöÑÂáΩÊï∞
            function updateMusicList(musicList) {
                const musicListElement = document.querySelector('.music-list');
                musicListElement.innerHTML = '';
                
                musicList.forEach((music, index) => {
                    const musicItem = document.createElement('div');
                    musicItem.className = 'music-item' + (index === 0 ? ' active' : '');
                    musicItem.dataset.src = music.src;
                    musicItem.textContent = music.name;
                    musicListElement.appendChild(musicItem);
                });

                // ËÆæÁΩÆÈªòËÆ§Èü≥‰πê
                if (musicList.length > 0) {
                    bgMusic.src = musicList[0].src;
                    musicTitle.textContent = musicList[0].name;
                }

                // ÈáçÊñ∞ÁªëÂÆöÈü≥‰πêÈ°πÁöÑÁÇπÂáª‰∫ã‰ª∂
                bindMusicItemEvents();
            }

            // ÁªëÂÆöÈü≥‰πêÈ°πÁÇπÂáª‰∫ã‰ª∂ÁöÑÂáΩÊï∞
            function bindMusicItemEvents() {
                const musicItems = document.querySelectorAll('.music-item');
                musicItems.forEach(item => {
                    item.addEventListener('click', function() {
                        const src = this.dataset.src;
                        const title = this.textContent;
                        
                        // Êõ¥Êñ∞Èü≥‰πêÊ∫ê
                        bgMusic.src = src;
                        musicTitle.textContent = title;
                        
                        // Êõ¥Êñ∞ÊøÄÊ¥ªÁä∂ÊÄÅ
                        musicItems.forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Êí≠ÊîæÊñ∞Èü≥‰πê
                        if (isPlaying) {
                            bgMusic.play().catch(error => {
                                console.log('Êí≠ÊîæÂ§±Ë¥•:', error);
                            });
                        }
                        
                        // ÂÖ≥Èó≠Èü≥‰πêÂàóË°®
                        musicList.classList.remove('show');
                    });
                });
            }

            // Âú®È°µÈù¢Âä†ËΩΩÊó∂Êâ´ÊèèÈü≥‰πêÊñá‰ª∂Â§π
            window.addEventListener('load', function() {
                // Êâ´ÊèèÈü≥‰πêÊñá‰ª∂Â§π
                scanMusicFolder();
                
                // ÂÖ∂‰ªñÁé∞ÊúâÁöÑ load ‰∫ã‰ª∂Â§ÑÁêÜ‰øùÊåÅ‰∏çÂèò...
            });

            // ÂÆö‰πâÁÖßÁâáÊï∞ÁªÑ
            let photos = []; // Êîπ‰∏∫ÂÖ®Â±ÄÂèòÈáè

            // Ê∑ªÂä†Êâ´ÊèèÂõæÁâáÊñá‰ª∂Â§πÁöÑÂáΩÊï∞
            async function scanPictureFolder() {
                try {
                    const response = await fetch('/love-site/backend/picture/');
                    if (!response.ok) throw new Error('Failed to load picture directory');
                    
                    const files = await response.json();
                    photos = files.map(file => `/love-site/backend/picture/${file}`);
                    
                    if (photos.length === 0) {
                        // Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÂõæÁâáÔºå‰ΩøÁî®ÈªòËÆ§ÂõæÁâá
                        photos = [
                            '/love-site/music/1.jpg',
                            '/love-site/music/2.jpg',
                            '/love-site/music/3.jpg'
                        ];
                    }
                } catch (error) {
                    console.error('Error loading pictures:', error);
                    // Âá∫ÈîôÊó∂‰ΩøÁî®ÈªòËÆ§ÂõæÁâá
                    photos = [
                        '/love-site/music/1.jpg',
                        '/love-site/music/2.jpg',
                        '/love-site/music/3.jpg'
                    ];
                }
            }

            // Âú®È°µÈù¢Âä†ËΩΩÊó∂Êâ´ÊèèÂõæÁâá
            window.addEventListener('DOMContentLoaded', async function() {
                await scanPictureFolder();
                // ... ÂÖ∂‰ªñÂàùÂßãÂåñ‰ª£Á†Å
            });

            // ÂàõÂª∫Áõ∏Ê°ÜÂáΩÊï∞
            function createPhotoFrame() {
                const frame = document.createElement('div');
                frame.className = 'photo-frame';
                
                // ÂàõÂª∫ÂõæÁâáÂÖÉÁ¥†
                const img = document.createElement('img');
                img.src = photos[Math.floor(Math.random() * photos.length)];
                frame.appendChild(img);
                
                // ÈöèÊú∫‰ΩçÁΩÆ
                const x = Math.random() * (window.innerWidth - 300) + 50;
                const y = Math.random() * (window.innerHeight - 350) + 50;
                frame.style.left = x + 'px';
                frame.style.top = y + 'px';
                
                // ÈöèÊú∫ÊóãËΩ¨ËßíÂ∫¶
                const rotation = Math.random() * 30 - 15;
                frame.style.transform = `rotate(${rotation}deg)`;
                
                document.body.appendChild(frame);
                
                // Ê∑ªÂä†Âá∫Áé∞Âä®Áîª
                frame.animate([
                    { 
                        transform: `translate(0, 50px) rotate(${rotation}deg)`,
                        opacity: 0 
                    },
                    { 
                        transform: `translate(0, 0) rotate(${rotation}deg)`,
                        opacity: 1 
                    }
                ], {
                    duration: 1000,
                    easing: 'ease-out',
                    fill: 'forwards'
                });

                // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ÔºàÂèØ‰ª•ÊîæÂ§ßÊü•ÁúãÔºâ
                frame.addEventListener('click', function() {
                    this.style.zIndex = '1000';
                    const currentTransform = this.style.transform;
                    
                    this.animate([
                        { transform: currentTransform },
                        { transform: 'translate(-50%, -50%) scale(2) rotate(0deg)' }
                    ], {
                        duration: 500,
                        easing: 'ease-out',
                        fill: 'forwards'
                    });

                    // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÊÅ¢Â§ç
                    const closeHandler = function(e) {
                        if (!frame.contains(e.target)) {
                            frame.style.zIndex = '48';
                            frame.animate([
                                { transform: 'translate(-50%, -50%) scale(2) rotate(0deg)' },
                                { transform: currentTransform }
                            ], {
                                duration: 500,
                                easing: 'ease-out',
                                fill: 'forwards'
                            });
                            document.removeEventListener('click', closeHandler);
                        }
                    };
                    
                    document.addEventListener('click', closeHandler);
                });
            }

            // ‰øÆÊîπ startAllAnimations ÂáΩÊï∞ÔºåÊ∑ªÂä†Áõ∏Ê°ÜÂàõÂª∫
            function startAllAnimations() {
                // ÂºÄÂßãÊí≠ÊîæÈªòËÆ§Èü≥‰πê
                if (defaultMusic.length > 0) {
                    bgMusic.src = defaultMusic[0].src;
                    musicTitle.textContent = defaultMusic[0].name;
                    bgMusic.play().catch(function(error) {
                        console.log('Ëá™Âä®Êí≠ÊîæÂ§±Ë¥•ÔºåÈúÄË¶ÅÁî®Êà∑‰∫§‰∫í:', error);
                    });
                    isPlaying = true;
                    document.querySelector('.music-icon')?.classList.remove('paused');
                }

                // ÂºÄÂßãÊñáÂ≠óÂä®Áîª
                setInterval(() => {
                    const count = Math.floor(Math.random() * 2) + 1;
                    for(let i = 0; i < count; i++) {
                        setTimeout(createFloatingWord, i * 100);
                    }
                }, 1000);

                // ÂàùÂßãÂàõÂª∫‰∏ÄÊâπÊñáÂ≠ó
                for(let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        createFloatingWord();
                    }, i * 150);
                }

                // ÂºÄÂßãÁà±ÂøÉÂä®Áîª
                startBigHeartInterval();

                // Êâ´ÊèèÈü≥‰πêÊñá‰ª∂Â§π
                scanMusicFolder();
            }

            const config = {
                baseUrl: '/love-site',
                paths: {
                    music: '/music',
                    pictures: '/pictures'
                },
                getPath: function(type, filename) {
                    return `${this.baseUrl}${this.paths[type]}/${filename}`;
                }
            };

            // ÁÑ∂ÂêéÂú®‰ª£Á†Å‰∏≠‰ΩøÁî®
            const musicPath = config.getPath('music', 'bgm.mp3');
            const picturePath = config.getPath('pictures', 'photo1.jpg');
        </script>
    </div>
</body>
</html>
